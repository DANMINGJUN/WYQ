<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>送给王毓琦小妹妹</title>
	<meta name="author" content="Mike">

	<link rel="stylesheet" href="./jscss/style.css" type="text/css" media="all">
	<!--导库-->
	<script type="text/javascript" src="./jscss/jquery.js"></script>
	<!-- 图片幻灯片效果-->
	<script type="text/javascript" src="./jscss/roundabout.js"></script>
	<script type="text/javascript" src="./jscss/roundabout_shapes.js"></script>
	<script type="text/javascript" src="./jscss/gallery_init.js"></script>
	<!-- 下雪-->
	<script type="text/javascript" src="./jscss/snowstorm.js"></script>
	<!-- 打字机效果-->
	<script type="text/javascript" src="./jscss/text.js"></script>
	<!-- 画爱心-->
	<script type="text/javascript" src="./jscss/ga.js" async=""></script>
	<script type="text/javascript" src="./jscss/heart.js"></script>
	<!-- 移动div-->
	<script type="text/javascript" src="./jscss/move.js"></script>
	<!-- 显示时间 -->
	<script type="text/javascript" src="./jscss/time.js"></script>
	<!-- 设置文字跟随鼠标 -->
	<script type="text/javascript" src="./jscss/makesnake.js"></script>
</head>

<body>
	    <ul class="DADAD">
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
			</ul>
	<!-- thanks for watching! -->
	<span id="span0" class="spanstyle">T</span><span id="span1" class="spanstyle">h</span>
	<span id="span2" class="spanstyle">a</span><span id="span3" class="spanstyle">n</span>
	<span id="span4" class="spanstyle">k</span><span id="span5" class="spanstyle">s</span><span id="span6"
		class="spanstyle">
	</span><span id="span7" class="spanstyle">f</span><span id="span8" class="spanstyle">o</span><span id="span9"
		class="spanstyle">r</span>
	<span id="span10" class="spanstyle"> </span><span id="span11" class="spanstyle">w</span>
	<span id="span12" class="spanstyle">a</span><span id="span13" class="spanstyle">t</span><span id="span14"
		class="spanstyle">c</span><span id="span15" class="spanstyle">h</span>
	<span id="span16" class="spanstyle">i</span><span id="span17" class="spanstyle">n</span><span id="span18"
		class="spanstyle">g</span><span id="span19" class="spanstyle">!</span>



	<script type="text/javascript">
		setTimeout(makesnake, 42000);
	</script>
	<!--#Header-->
	<div id="header" style="opacity:0.85">
		<div id="title">
			I Love You Forever
		</div>
	</div>

	<!-- #myContent -->
	<div id="myContent">
		<span id="blink" style="display: none;">_</span></div>
	<div id="contentToWrite" style="display:none">
		该怎么说呢，<br>
		感觉好多话我都想说, <br>
		小琦总是这么可爱，<br>
		不管前面的路如何崎岖，<br>
		不管经历过什么,<br>
		蛋蛋也只想和小琦一起前往最好的一天，<br>
    一切似乎都是那么遥远,又似乎那么触手可及.<br>
    蛋蛋总是那么傻乎乎的感觉，<br>
		蛋蛋想要一直守在小琦身边，<br>
		小琦也会一直陪着蛋蛋的.<br>
		<br>
		-----------------------Just for You<br>
	</div>
	<script type="text/javascript">
		writeContent(true);
	</script>


	<!-- #container -->
	<div id="container">
		<ul id="myRoundabout" class="roundabout-holder" style="padding: 0px; position: relative; z-index: 100;">
			<li class="roundabout-moveable-item roundabout-in-focus" current-scale="1.0000"
				style="position: absolute; left: 122px; top: 87px; width: 350px; height: 222px; opacity: 1; z-index: 400; font-size: 16px;">
				<img src="./jscss/1.jpg" alt=""></li>
			<li class="roundabout-moveable-item" current-scale="0.7927"
				style="position: absolute; left: -0.4px; top: 110px; width: 277.445px; height: 175.9794px; opacity: 1; z-index: 296; font-size: 12.68px;">
				<img src="./jscss/2.jpg" alt=""></li>
			<li class="roundabout-moveable-item" current-scale="0.4573"
				style="position: absolute; left: 473.8px; top: 147.2px; width: 160.055px; height: 101.5206px; opacity: 1; z-index: 129; font-size: 7.32px;">
				<img src="./jscss/3.jpg" alt=""></li>
			<li class="roundabout-moveable-item" current-scale="0.4573"
				style="position: absolute; left: -39.8px; top: 147.2px; width: 160.055px; height: 101.5206px; opacity: 1; z-index: 129; font-size: 7.32px;">
				<img src="./jscss/4.jpg" alt=""></li>
			<li class="roundabout-moveable-item" current-scale="0.7927"
				style="position: absolute; left: 317px; top: 110px; width: 277.445px; height: 175.9794px; opacity: 1; z-index: 296; font-size: 12.68px;">
				<img src="./jscss/5.jpg" alt=""></li>
		</ul>
	</div>
	<script type="text/javascript">
		setTimeout(move, 15000);
	</script>

	<!-- #bg -->
	<div style="margin-top:-400px ;;;" id="bg">
		<canvas id="garden" width="1583" height="709">
			<c style="color: #FFF; text-shadow:2px 3px 3px #222; font-family:Microsoft YaHei; font-size:50px">
				卑微浏览器过时了哈哈！！！</c>
		</canvas>
	</div>

	<!-- #time -->
	<div id="time">
		<span id="show"></span>
		<script type="text/javascript">
			setTimeout("showTime()", 40000);
		</script>
	</div>


<script>
Object.getOwnPropertyNames(Math).map(function(p) {
  window[p] = Math[p];
});

var rand = function(max, min, is_int) {
  var max = (max - 1 || 0) + 1, 
      min = min || 0, 
      gen = min + (max - min)*random();
  
  return (is_int)?round(gen):gen;
};

var σ = function(c) {
  return (random() < (c || .5))?-1:1;
}

var N_POLY = 32, 
    c = document.querySelector('canvas'), 
    ctx = c.getContext('2d'), 
    w = 150, h = 150, 
    polygons = [], 
    t = 0, r_id = null, 
    rep_pt = {'x': 0, 'y': 0}, 
    cutoff_d = 169;

var Poly = function(n, R, o, φ, hue, v, af, ω) {
  this.n = n || rand(7, 3, 1);
  this.α = 2*PI/this.n;
  this.R = R || rand(16, 8);
  this.o = o || null;
  this.φ = φ || rand(PI/2);
  this.hue = hue || rand(360, 0, 1);
  this.c = 'hsl(' + this.hue + ',100%,80%)';
  this.v = v || null;
  this.af = af || (25 - this.R)/250 - 1;
  this.ω = ω || σ()*rand(2, .25)*PI/180;
  this.vertices = [];
  
  this.init = function() {
    var θ = 0;
    
    if(!this.o) {
      this.o = {
        'x': rand(w - this.R, this.R, 1), 
        'y': rand(h - this.R, this.R, 1)
      };
    }
    
    if(!this.v) {
      this.v = {
        'x': σ()*rand(2, .5), 
        'y': σ()*rand(2, .5)
      };
    }
    
    for(var i = 0; i < this.n; i++) {
      θ = i*this.α + this.φ;
            
      this.vertices.push({
        'x': this.o.x + this.R*cos(θ), 
        'y': this.o.y + this.R*sin(θ)
      });
    }
  };
  
  this.move = function() {
    this.v.x += ~~(2/(this.o.x - rep_pt.x));
    this.v.y += ~~(2/(this.o.y - rep_pt.y));
    
    if(this.v.x > 4) { this.v.x = 4; }
    if(this.v.y > 4) { this.v.y = 4; }
    if(this.v.x < -4) { this.v.x = -4; }
    if(this.v.y < -4) { this.v.y = -4; }
    
    this.o.x += this.v.x;
    this.o.y += this.v.y;
    
    this.φ += this.ω;
    this.hue += σ(.8)*rand(5, 1, 1);
    this.c = 'hsl(' + this.hue + ',100%,80%)';
    
    if(this.o.x < this.R) {
      this.o.x = this.R;
      this.v.x *= this.af;
    }
    if(this.o.x > w - this.R) {
      this.o.x = w - this.R;
      this.v.x *= this.af;
    }
    if(this.o.y < this.R) {
      this.o.y = this.R;
      this.v.y *= this.af;
    }
    if(this.o.y > h - this.R) {
      this.o.y = h - this.R;
      this.v.y *= this.af;
    }
    
    for(var i = 0; i < N_POLY; i++) {
      if(polygons[i] != this) {
        if(abs(this.o.x - polygons[i].o.x) < (this.R + polygons[i].R) && 
           abs(this.o.y - polygons[i].o.y) < (this.R + polygons[i].R)) {
          this.o.x -= this.v.x;
          polygons[i].o.x -= polygons[i].v.x;
          this.v.x *= -1;
          polygons[i].v.x *= -1;
          this.o.y -= this.v.y;
          polygons[i].o.y -= polygons[i].v.y;
          this.v.y *= -1;
          polygons[i].v.y *= -1;
        }
      }
    }
    
    for(var i = 0; i < this.n; i++) {
      θ = i*this.α + this.φ;
            
      this.vertices[i] = {
        'x': this.o.x + this.R*cos(θ), 
        'y': this.o.y + this.R*sin(θ)
      };
    }
  };
  
  this.draw = function(ctxt) {
    ctxt.lineWidth = 3;
    ctxt.strokeStyle = this.c;
    ctxt.beginPath();
    
    for(var i = 0; i < this.n; i++) {
      if(i == 0) {
        ctxt.moveTo(this.vertices[i].x, this.vertices[i].y);
      }
      else {
        ctxt.lineTo(this.vertices[i].x, this.vertices[i].y);
      }
    }
    
    ctxt.closePath();
    ctxt.stroke();
  };
  
  this.connectTo = function(ctxt, poly) {
    var min_d = max(w, h), conn_i, conn_j, 
        curr_d, dx, dy, 
        c0, c1, g, la;
    
    for(var i = 0; i < this.n; i++) {
      for(var j = 0; j < poly.n; j++) {
        dx = this.vertices[i].x - poly.vertices[j].x;
        dy = this.vertices[i].y - poly.vertices[j].y;
        curr_d = sqrt(pow(dx, 2) + pow(dy, 2));
        if(min_d > curr_d) {
          min_d = curr_d;
          conn_i = i;
          conn_j = j;
        }
      }
    }
    
    if(min_d < cutoff_d) {
      la = (1 - min_d/cutoff_d);
      c0 = 'hsla(' + this.hue + ',100%,80%,' + la + ')';
      c1 = 'hsla(' + poly.hue + ',100%,80%,' + la + ')';
      g = ctxt.createLinearGradient(
        this.vertices[conn_i].x, 
        this.vertices[conn_i].y, 
        poly.vertices[conn_j].x, 
        poly.vertices[conn_j].y
      );
      g.addColorStop(0, c0);
      g.addColorStop(1, c1);
      
      ctxt.strokeStyle = g;
      ctxt.beginPath();
      ctxt.moveTo(this.vertices[conn_i].x, 
        this.vertices[conn_i].y);
      ctxt.lineTo(poly.vertices[conn_j].x, 
        poly.vertices[conn_j].y);
      ctxt.closePath();
      ctxt.stroke()
    }
  };
};

var init = function() {
  var s = getComputedStyle(c);
  
  if(r_id) {
    cancelAnimationFrame(r_id);
  }
  
  w = c.width = ~~s.width.split('px')[0];
  h = c.height = ~~s.height.split('px')[0];
  
  rep_pt = {'x': w/2, 'y': h/2};
  
  for(var i = 0; i < N_POLY; i++) {
    polygons.push(new Poly());
    polygons[i].init();
  }
  
  draw();
};

var draw = function() {
  var hue_diff;
  
  ctx.clearRect(0, 0, w, h);
  
  for(var i = 0; i < N_POLY; i++) {
    polygons[i].move();
    polygons[i].draw(ctx);
    
    for(var j = 0; j < i; j++) {
      hue_diff = abs(polygons[i].hue - polygons[j].hue);
      
      if(hue_diff < 32 || hue_diff > 328) {
        polygons[i].connectTo(ctx, polygons[j]);
      }
    }
  }
  
  t++;
  
  r_id = requestAnimationFrame(draw);
};

setTimeout(function() {
  init();
  
  addEventListener('resize', init, false);
  
  c.addEventListener('mousemove', function(e) {
    rep_pt = {'x': e.clientX, 'y': e.clientY}
  }, false);
}, 15);
</script>

</body>